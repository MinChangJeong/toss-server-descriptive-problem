## Ex) Caching 실습

### 대용량 트래픽 환경에서 게시글 검색시 캐싱 적용하기 
출처 - https://junshock5.tistory.com/105 -

- cahing을 적용해 보려는 이유
 : 이전 SNS프로젝트를 진행하면서 데이터를 READ할때 항상 DB에 접근하면서 시간을 오래 잡아 먹는 일이 있었는데 이부분을 고정적인 데이터를
   가져오는 경우 caching을 이용해 시간을 줄이기 위해서이다.
   
- 캐시를 언제 써야 하는지에 대한 정리

 1. 반복적으로 동일한 결과를 리턴해야 하는 작업
   -> 내가 진행한 플젝에서는 로그인한 유저의 정보를 보여줄때 항상 동일한 결과를 리턴 해야하는데 이 부분에서 적용할 수 있을것 같다
 
 2. 서버 자원을 많이 사용하는 작업 또는 시간이 오래 걸리는 작업(API호출, 데이터베이스 조회 쿼리 등등)
 
 3. 자주 조회 되는 데이터
 
 4. 입력과 출력 값이 일정한 데이터
     -> 캐싱된 데이터는 데이터 갱신으로 인해 DB와 불일치가 발생할 수 있다.
       update가 잦거나 데이터 불일치 시 비즈니스 로직 상 문제가 발생할 수 있는 경우에는 캐싱 대상으로 부적절함

ex> used-market-service에서 캐싱 대상 알아보기

  - 게시글 리스트와 게시글 : 자주 조회되는 데이터로 DB서버에 부하를 줄일 수 있다.
  - 중고거래 서비스 특성상 최신 게시글이 5초 정도 늦게 올라온다고 서비스에 큰 무리가 가지 않는 다고 판단하여 
    중고물품 캐싱 만료 시간을 5초로 설정
    
    
### Local Cache / Global Cache 

- Local Cache
  - 서버마다 캐시를 따로 저장한다.
  - 다른 서버의 캐시를 참조하기 어렵다.
  - 서버 내에서 작동하기 때문에 속도가 빠르다.
  - 로컬 서버 장비의 resource를 이용한다. (Memory, Disk)
  - 캐시에 저장된 데이터가 변경되는 경우 : 
    - 해당 서버를 제외한 모든 peer에 해당 변경 사항 전달
    - all-to-all repllaction
    - was 인스턴스가 늘어나고, 캐시 저장 데이터 크기가 커지면 성능이 저하되는 이유는 이때문
    
    :: WAS란? 
    - 웹 프로그램(혹은 웹 시스템, 웹 사이트, 웹 서비스 등)을 실행할 수 있는 기초적인 환경을 제공
    - WebsLogic, WebShpere, tomcat, Jeus, JBoss등이 있다.
    
- Global Cache
  - 여러 서버에서 캐시 서버에 접근하여 참조 할수 있다.
  - 별도의 캐시 서버를 이용하기 때문에 서버간 데이터 공유가 쉽다.
  - 네트워크 트래픽을 사용해야 해서 로컬 캐시보다는 느리다
  - 데이터 분산하여 저장 할 수 있다.
      - Replication : 두 개 이상의 DBMS시스템을 Master / slave로 나눠서 동일한 데이터를 저장하는 방식
      - Sharding : 같은 테이블 스키마를 가진 데이터를 다수의 데이터베이스에 분산하여 저장하는 방법
  - 캐시에 저장된 데이터가 변경되는 경우
      - 추가적인 작업 필요 없음
      - 서비스 확장으로 WAS인스턴스가 늘어나고, Cache 데이터 크기가 커질수록 효과적인 이유
      
      
 ### Scale-up / scale-out 환경별 캐싱 전략 특징 
 
  - scale-up 환경에선 local cache적용
    - scale-up(서버 그자체를 증강하는 것에 의해서 처리 능력을 향상시키는 것) 환경에선 서버가 1개이어서 local cache로 데이터 처리가 가능하다.
    - 캐시된 데이터가 서버사이에 일관되지 않아도 됩니다. 즉 서버간 태싱 데이터를 참조할 필요가 없다.
    
  - scale-out(접속된 서버의 대수를 늘려 처리 능력을 향상시키는 것) 환경에선 Global-cache적용
      - Scale-up 환경에선 여러 서버에서 캐시 서버를 참조해야 합니다.
      - 서버간 데이터를 고유해야하는 환경입니다.즉 캐싱된 데이터가 일관되려면 서버간 캐싱 데이터를 참조해야 합니다.
  
  

### Redis 란?

- Redis (Remote Dictionary Server) 는 메모리 기반의 "키-값" 구조 데이터 관리 시스템이며, 모든 데이터를 메모리에 저장하고 조회하기 에빠른 
  Read, write속도를 보장하는 비 관계형 데이터 베이스이다.ㄴ
  
